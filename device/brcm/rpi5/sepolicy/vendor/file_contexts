# Raspberry Pi 5 SELinux File Contexts
# Android 16 - AIDL HALs

# Device files
/dev/gpiochip[0-9]*              u:object_r:gpio_device:s0
/dev/gpiomem                     u:object_r:gpio_device:s0
/dev/i2c-[0-9]*                  u:object_r:i2c_device:s0
/dev/spidev[0-9]*\.[0-9]*        u:object_r:spidev_device:s0
/dev/ttyAMA[0-9]*                u:object_r:serial_device:s0
/dev/v4l-subdev[0-9]*            u:object_r:video_device:s0
/dev/media[0-9]*                 u:object_r:video_device:s0
/dev/dri/card[0-9]*              u:object_r:gpu_device:s0
/dev/dri/renderD[0-9]*           u:object_r:gpu_device:s0
/dev/fb[0-9]*                    u:object_r:fb_device:s0
/dev/input/event[0-9]*           u:object_r:input_device:s0

# Camera devices
/dev/bcm2835-isp                 u:object_r:bcm_isp_device:s0
/dev/bcm2835-codec               u:object_r:bcm_isp_device:s0
/dev/rpivid-.*                   u:object_r:video_device:s0

# PCIe NPU / AI Accelerator devices (use generic pci_device)
/dev/apex_[0-9]*                 u:object_r:pci_device:s0
/dev/hailo[0-9]*                 u:object_r:pci_device:s0
/dev/hailo_pci                   u:object_r:pci_device:s0
/dev/myriad[0-9]*                u:object_r:usb_device:s0
/dev/kneron[0-9]*                u:object_r:pci_device:s0
/dev/accel[0-9]*                 u:object_r:pci_device:s0

# AIDL HAL executables (Android 16)
/vendor/bin/hw/android\.hardware\.gpio-service\.rpi5           u:object_r:hal_gpio_rpi5_exec:s0
/vendor/bin/hw/android\.hardware\.power-service\.rpi5          u:object_r:hal_power_rpi5_exec:s0
/vendor/bin/hw/android\.hardware\.thermal-service\.rpi5        u:object_r:hal_thermal_rpi5_exec:s0
/vendor/bin/hw/android\.hardware\.light-service\.rpi5          u:object_r:hal_light_rpi5_exec:s0
/vendor/bin/hw/android\.hardware\.usb-service\.rpi5            u:object_r:hal_usb_rpi5_exec:s0
/vendor/bin/hw/android\.hardware\.camera\.provider-service\.rpi5  u:object_r:hal_camera_rpi5_exec:s0
/vendor/bin/hw/android\.hardware\.audio\.core-service\.rpi5    u:object_r:hal_audio_rpi5_exec:s0
/vendor/bin/hw/android\.hardware\.graphics\.display-service\.rpi5  u:object_r:hal_display_rpi5_exec:s0
/vendor/bin/hw/android\.hardware\.input\.touch-service\.rpi5   u:object_r:hal_touch_rpi5_exec:s0
/vendor/bin/hw/android\.hardware\.npu-service\.rpi5            u:object_r:hal_npu_rpi5_exec:s0

# Sysfs contexts
/sys/class/gpio(/.*)?                    u:object_r:sysfs_gpio:s0
/sys/devices/platform/.*gpio.*/gpio(/.*)?  u:object_r:sysfs_gpio:s0
/sys/class/drm(/.*)?                     u:object_r:sysfs_drm:s0
/sys/class/backlight(/.*)?               u:object_r:sysfs_backlight:s0
/sys/class/pwm(/.*)?                     u:object_r:sysfs_pwm:s0
/sys/bus/pci(/.*)?                       u:object_r:sysfs_pci:s0
/sys/devices(/.*)?                       u:object_r:sysfs_devices:s0
/sys/class/video4linux(/.*)?             u:object_r:sysfs_video:s0
