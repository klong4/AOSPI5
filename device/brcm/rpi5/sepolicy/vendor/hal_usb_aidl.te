# SELinux policy for AIDL USB HAL - Android 16
# Raspberry Pi 5

type hal_usb_rpi5, domain;
type hal_usb_rpi5_exec, exec_type, vendor_file_type, file_type;

init_daemon_domain(hal_usb_rpi5)
binder_use(hal_usb_rpi5)

# Allow USB HAL to serve AIDL interface
hal_server_domain(hal_usb_rpi5, hal_usb)

# USB gadget control
allow hal_usb_rpi5 sysfs:dir r_dir_perms;
allow hal_usb_rpi5 sysfs:file rw_file_perms;
allow hal_usb_rpi5 sysfs:lnk_file r_file_perms;

# ConfigFS for USB gadget
allow hal_usb_rpi5 configfs:dir rw_dir_perms;
allow hal_usb_rpi5 configfs:file rw_file_perms;
allow hal_usb_rpi5 configfs:lnk_file create_file_perms;
