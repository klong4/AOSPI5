# Raspberry Pi 5 Audio HAL SELinux Policy
type hal_audio_rpi5, domain;
type hal_audio_rpi5_exec, exec_type, vendor_file_type, file_type;

init_daemon_domain(hal_audio_rpi5)

hal_server_domain(hal_audio_rpi5, hal_audio)

# Access to sound devices
allow hal_audio_rpi5 audio_device:chr_file rw_file_perms;
allow hal_audio_rpi5 audio_device:dir r_dir_perms;

# Allow audio HAL to read from sysfs
allow hal_audio_rpi5 sysfs:file r_file_perms;
allow hal_audio_rpi5 sysfs:dir r_dir_perms;

# Allow audio HAL to access mixer
allow hal_audio_rpi5 vendor_configs_file:file r_file_perms;
allow hal_audio_rpi5 vendor_configs_file:dir r_dir_perms;

# Binder access
binder_call(hal_audio_rpi5, audioserver)
binder_call(audioserver, hal_audio_rpi5)

# HwBinder
hwbinder_use(hal_audio_rpi5)
